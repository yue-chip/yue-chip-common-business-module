import{i as T,j as d,q as $,c as A,w as o,n as E,s as G,o as H,h as t,u as n,p as b}from"./vue-router-ef9fc363.js";import{a as p,C as M,m as N,I as V,b as W,F as j,B as J,_ as K,c as L,d as Q}from"./axios-85071db1.js";import{_ as w}from"./index-c71dfe88.js";import{S as X,U as Y,R as Z}from"./UndoOutlined-6ce0729a.js";import{_ as ee}from"./index-9035f93f.js";const ue=T({__name:"addOrUpdate",setup(ae){const U=E(),f=G(),m=d(),q=w.SHOW_PARENT;let g=d(!1),y=d(!1),h=d(!1),l=d({}),_=d([]);const C={name:[{required:!0,message:"请输入机构名称",trigger:"blur"}],sort:[{required:!0,message:"请输入机构排序",trigger:"blur"}],phoneNumber:[{required:!0,message:"请输入紧急联系电话",trigger:"blur"}]};$(()=>{const a=f.query.id;a&&x(a),p.axiosGet("/upms/console/organizational/tree/select",{params:{id:a}},e=>{if(e.status===200){_.value=e.data;for(let s of _.value){let u,i;s.value===a&&(u=s.selectable=!1,i=s.disabled=!0);for(let c of s.children)k(a,c,u,i)}}},null,null)});function k(a,e,s,u){s!=null&&u!=null?(e.selectable=s,e.disabled=u):e.value===a&&(s=e.selectable=!1,u=e.disabled=!0);for(let i of e.children)k(a,i,s,u)}function O(){U.go(-1)}function z(){l.value={},m.value.resetFields();const a=f.query.id;a&&x(a)}async function x(a){p.axiosGet("/upms/console/organizational/details",{params:{id:a}},e=>{e.status===200&&(l.value=e.data,l.value.parentId==="0"&&(l.value.parentId=null))},null,null)}function R(){I(!0,!0,!0);const a=f.query.id;a&&(l.value.id=a),m.value.validateFields().then(()=>{l.value.id?p.axiosPut("/upms/console/organizational/update",l.value,e=>{e.status===200&&N.info(e.message)},null,null):p.axiosPost("/upms/console/organizational/add",l.value,e=>{e.status===200&&N.info(e.message)},null,null)}).catch(e=>{}).finally(()=>{I(!1,!1,!1)})}function I(a,e,s){g.value=a,y.value=e,h.value=s}return(a,e)=>{const s=V,u=W,i=w,c=ee,B=j,v=J,D=K,S=L,F=Q,P=M;return H(),A(P,{class:"card",bordered:!1},{default:o(()=>[t(B,{ref_key:"from",ref:m,rules:C,model:n(l),layout:"horizontal","label-col":{span:4,offset:0},"wrapper-col":{span:16,offset:0}},{default:o(()=>[t(u,{label:"机构名称",name:"name",ref:"name"},{default:o(()=>[t(s,{placeholder:"请输入机构名称",value:n(l).name,"onUpdate:value":e[0]||(e[0]=r=>n(l).name=r)},null,8,["value"])]),_:1},512),t(u,{label:"紧急联系电话",name:"phoneNumber",ref:"phoneNumber"},{default:o(()=>[t(s,{placeholder:"请输入紧急联系电话",value:n(l).phoneNumber,"onUpdate:value":e[1]||(e[1]=r=>n(l).phoneNumber=r)},null,8,["value"])]),_:1},512),t(u,{label:"上级机构",name:"parentId",ref:"parentId"},{default:o(()=>[t(i,{value:n(l).parentId,"onUpdate:value":e[2]||(e[2]=r=>n(l).parentId=r),"tree-data-simple-mode":"",style:{width:"100%"},"tree-data":n(_),"allow-clear":"","show-checked-strategy":n(q),placeholder:"请选择上级节点","tree-node-filter-prop":"label"},null,8,["value","tree-data","show-checked-strategy"])]),_:1},512),t(u,{label:"排序",name:"sort",ref:"sort"},{default:o(()=>[t(c,{value:n(l).sort,"onUpdate:value":e[3]||(e[3]=r=>n(l).sort=r),min:0,max:99999},null,8,["value"])]),_:1},512)]),_:1},8,["model"]),t(F,null,{default:o(()=>[t(S,{span:24,style:{"text-align":"center"}},{default:o(()=>[t(u,null,{default:o(()=>[t(D,{size:5},{default:o(()=>[t(v,{type:"primary",disabled:n(g),onClick:e[4]||(e[4]=r=>R())},{icon:o(()=>[t(n(X))]),default:o(()=>[b(" 保存 ")]),_:1},8,["disabled"]),t(v,{type:"dashed",disabled:n(y),onClick:e[5]||(e[5]=r=>z())},{icon:o(()=>[t(n(Y))]),default:o(()=>[b(" 重置 ")]),_:1},8,["disabled"]),t(v,{type:"dashed",disabled:n(h),onClick:O},{icon:o(()=>[t(n(Z))]),default:o(()=>[b(" 返回 ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}});export{ue as default};
