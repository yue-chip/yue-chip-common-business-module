import{h as t,i as Z,j as g,k as K,l as ee,w as e,u as s,m as te,n as ne,o as y,p as h,c as w,b as S}from"./vue-router-ef9fc363.js";import{A as q,a as b,m as O,C as ae,P as le,B as oe,_ as se,b as ie,c as re,d as ue,F as ce}from"./axios-85071db1.js";import{q as de}from"./index-5f427048.js";import{M as j,E as pe,_ as me}from"./EditOutlined-007ce32e.js";import{D as B,_ as fe}from"./DeleteOutlined-ba572a4a.js";import{_ as _e}from"./index-bed09c85.js";var ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM664 565H360c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"meh",theme:"outlined"};const he=ge;function D(o){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(a);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(a).filter(function(d){return Object.getOwnPropertyDescriptor(a,d).enumerable}))),i.forEach(function(d){ve(o,d,a[d])})}return o}function ve(o,n,a){return n in o?Object.defineProperty(o,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[n]=a,o}var M=function(n,a){var i=D({},n,a.attrs);return t(q,D({},i,{icon:he}),null)};M.displayName="MehOutlined";M.inheritAttrs=!1;const ye=M;var be={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"};const Oe=be;function E(o){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(a);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(a).filter(function(d){return Object.getOwnPropertyDescriptor(a,d).enumerable}))),i.forEach(function(d){ke(o,d,a[d])})}return o}function ke(o,n,a){return n in o?Object.defineProperty(o,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[n]=a,o}var P=function(n,a){var i=E({},n,a.attrs);return t(q,E({},i,{icon:Oe}),null)};P.displayName="UserOutlined";P.inheritAttrs=!1;const Ce=P,$e=Z({__name:"index",setup(o){const n=ne();let a=g(!1),i=g({pageSize:10,pageNumber:1}),d=[],m=g(!1),f=g({}),U=g([]);const F=[{title:"机构名称",dataIndex:"name",fixed:"left",key:"name"},{title:"排序",dataIndex:"sort",key:"sort"},{title:"状态",key:"state"},{title:"负责人",dataIndex:"leaderName",key:"leaderName"},{title:"紧急联系电话",dataIndex:"phoneNumber",key:"phoneNumber"},{title:"创建时间",dataIndex:"createDateTime",key:"createDateTime"},{title:"操作",key:"operation",fixed:"right",width:"380px"}];let $=g([]);K(()=>{k()});function k(){a.value=!0,b.axiosGet("/upms/console/organizational/tree/list",{params:i.value},l=>{$.value=l.data,a.value=!1},null,null)}function R(){n.push("/addOrUpdate")}function V(l){n.push({path:"/addOrUpdate",query:{id:l}})}function N(l){if(!l||l.length===0){O.error("请选择要删除的数据！");return}j.confirm({title:"是否要删除该数据?",okText:"Yes",okType:"danger",cancelText:"No",onOk(){const r={params:{ids:l},paramsSerializer:u=>de.stringify(u,{indices:!1})};b.axiosDelete("/upms/console/organizational/delete",r,u=>{u.status===200&&(O.info(u.message),k())},null,null)},onCancel(){}})}function G(l,r,u,C,x){let z=r?1:0;b.axiosPut("/upms/console/organizational/update",{id:l,state:z,phoneNumber:u,name:C,parentId:x},v=>{v.status===200&&(O.info(v.message),k())},null,null)}function L(l){if(!l.stateTmp){O.warn("该机构被禁用，禁止操作");return}f.value=l,m.value=!0,b.axiosGet("/upms/console/organizational/user/select/list",{params:{organizationalId:l.id}},r=>{U.value=r.data,a.value=!1},null,null)}function T(){m.value=!1,f.value=[]}function H(){b.axiosPut("/upms/console/organizational/update",f.value,l=>{l.status===200&&(O.info(l.message),T(),k())},null,null)}function Y(l){n.push({path:"/grid",query:{organizationalId:l}})}return(l,r)=>{const u=oe,C=se,x=ie,z=re,v=ue,I=ce,A=ae,J=_e,Q=me,W=fe,X=j;return y(),ee("div",null,[t(A,null,{default:e(()=>[t(I,{ref:"from",model:s(i),"label-col":{span:4,offset:0}},{default:e(()=>[t(v,{style:{height:"20px"}},{default:e(()=>[t(z,{span:24,style:{"text-align":"right"}},{default:e(()=>[t(x,null,{default:e(()=>[t(C,{size:5},{default:e(()=>[t(u,{type:"primary",onClick:r[0]||(r[0]=p=>R())},{icon:e(()=>[t(s(le))]),default:e(()=>[h(" 添加 ")]),_:1}),t(u,{type:"primary",danger:"",onClick:r[1]||(r[1]=p=>N(s(d)))},{icon:e(()=>[t(s(B))]),default:e(()=>[h(" 删除 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(A,null,{default:e(()=>[t(Q,{rowKey:"id",columns:F,"data-source":s($),loading:s(a),scroll:{y:440}},{bodyCell:e(({column:p,text:xe,record:c})=>[p.key==="state"?(y(),w(J,{key:0,onChange:_=>G(c.id,c.stateTmp,c.phoneNumber,c.name,c.parentId),checked:c.stateTmp,"onUpdate:checked":_=>c.stateTmp=_,"checked-children":"正常","un-checked-children":"禁用"},null,8,["onChange","checked","onUpdate:checked"])):S("",!0),p.key==="operation"?(y(),w(C,{key:1,size:5},{default:e(()=>[t(u,{size:"small",onClick:_=>V(c.id)},{icon:e(()=>[t(s(pe))]),default:e(()=>[h(" 修改 ")]),_:2},1032,["onClick"]),t(u,{onClick:_=>L(c),size:"small"},{icon:e(()=>[t(s(Ce))]),default:e(()=>[h(" 设置负责人 ")]),_:2},1032,["onClick"]),c.children===void 0?(y(),w(u,{key:0,onClick:_=>Y(c.id),size:"small"},{icon:e(()=>[t(s(ye))]),default:e(()=>[h(" 网格管理 ")]),_:2},1032,["onClick"])):S("",!0),c.username!=="admin"?(y(),w(u,{key:1,size:"small",type:"primary",danger:"",onClick:_=>N(c.id)},{icon:e(()=>[t(s(B))]),default:e(()=>[h(" 删除 ")]),_:2},1032,["onClick"])):S("",!0)]),_:2},1024)):S("",!0)]),_:1},8,["data-source","loading"])]),_:1}),t(X,{width:"500px",visible:s(m),"onUpdate:visible":r[3]||(r[3]=p=>te(m)?m.value=p:m=p),title:"部门负责人",cancelText:"取消",okText:"保存",destroyOnClose:!0,mask:!0,maskClosable:!1,onCancel:T,onOk:H},{default:e(()=>[t(I,{ref:"leaderForm",model:s(f),labelCol:{span:0,offset:0}},{default:e(()=>[t(v,null,{default:e(()=>[t(z,{span:24},{default:e(()=>[t(x,{label:"负责人",name:"scope",ref:"scope"},{default:e(()=>[t(W,{options:s(U),allowClear:"",value:s(f).leaderId,"onUpdate:value":r[2]||(r[2]=p=>s(f).leaderId=p)},null,8,["options","value"])]),_:1},512)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])}}});export{$e as default};
